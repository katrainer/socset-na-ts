{"ast":null,"code":"import { v1 } from 'uuid';\nimport { profileAPI } from '../../api/profileApi';\nimport { changePreloaderAC, enumCommonActionType } from '../../common/commonReducer';\nimport { errorResponse } from '../../utils/util-error';\nexport let enumProfileActionType;\n\n(function (enumProfileActionType) {\n  enumProfileActionType[\"setNewPostClick\"] = \"PROFILE/SET-NEW-POST-CLICK\";\n  enumProfileActionType[\"setProfileUserData\"] = \"PROFILE/SET-PROFILE-USER-DATA\";\n  enumProfileActionType[\"setStatus\"] = \"PROFILE/SET-STATUS\";\n  enumProfileActionType[\"updatePhotos\"] = \"PROFILE/UPDATE-PHOTOS\";\n})(enumProfileActionType || (enumProfileActionType = {}));\n\nconst initialState = {\n  postsData: [{\n    id: v1(),\n    message: 'Memento mori',\n    likeCount: 12\n  }, {\n    id: v1(),\n    message: 'How are you guys?',\n    likeCount: 212\n  }, {\n    id: v1(),\n    message: 'Hello world!',\n    likeCount: 1212\n  }],\n  userProfilePage: {},\n  preloader: false,\n  status: ''\n};\nexport const profilePageReducer = function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case enumProfileActionType.setNewPostClick:\n      return { ...state,\n        postsData: [{ ...action.payload\n        }, ...state.postsData]\n      };\n\n    case enumProfileActionType.setProfileUserData:\n    case enumCommonActionType.changePreloader:\n    case enumProfileActionType.setStatus:\n      return { ...state,\n        ...action.payload\n      };\n\n    case enumProfileActionType.updatePhotos:\n      return { ...state,\n        userProfilePage: { ...state.userProfilePage,\n          ...action.payload.photos\n        }\n      };\n\n    default:\n      return { ...state\n      };\n  }\n}; //action\n\nexport const setNewPostClickAC = message => {\n  return {\n    type: enumProfileActionType.setNewPostClick,\n    payload: {\n      message,\n      likeCount: 0,\n      id: v1()\n    }\n  };\n};\nexport const setProfileUserDataAC = userProfilePage => {\n  return {\n    type: enumProfileActionType.setProfileUserData,\n    payload: {\n      userProfilePage\n    }\n  };\n};\nexport const setStatusAC = status => {\n  return {\n    type: enumProfileActionType.setStatus,\n    payload: {\n      status\n    }\n  };\n};\n\nconst updatePhotosAC = photos => {\n  return {\n    type: enumProfileActionType.updatePhotos,\n    payload: {\n      photos\n    }\n  };\n}; //thunk\n\n\nexport const setProfileUserDataTC = param => async (dispatch, getState) => {\n  dispatch(changePreloaderAC(true));\n  let userId = param.match.params.userId;\n\n  if (!userId) {\n    const id = getState().login.id;\n    userId = id;\n  }\n\n  try {\n    const res = await profileAPI.getProfileUserData(userId);\n    dispatch(setProfileUserDataAC(res.data));\n    dispatch(changePreloaderAC(false));\n  } catch (e) {\n    errorResponse(e);\n  }\n};\nexport const getStatusTC = param => async (dispatch, getState) => {\n  let userId = param.match.params.userId;\n\n  if (!userId) {\n    const id = getState().login.id;\n    userId = id;\n  }\n\n  try {\n    const res = await profileAPI.getProfileStatus(userId);\n    dispatch(setStatusAC(res.data));\n  } catch (e) {\n    errorResponse(e);\n  }\n};\nexport const updateStatusTC = status => async dispatch => {\n  const res = await profileAPI.updateProfileStatus(status);\n  if (res.data.resultCode === 0) dispatch(setStatusAC(status));\n};\nexport const updatePhotosTC = photo => async dispatch => {\n  try {\n    const res = await profileAPI.updateProfilePhoto(photo);\n    dispatch(updatePhotosAC(res.data.data));\n  } catch (e) {\n    errorResponse(e);\n  }\n}; //type","map":{"version":3,"sources":["D:/It-inkubator/socset-na-ts/src/redux/reducer/profilePageReducer.ts"],"names":["v1","profileAPI","changePreloaderAC","enumCommonActionType","errorResponse","enumProfileActionType","initialState","postsData","id","message","likeCount","userProfilePage","preloader","status","profilePageReducer","state","action","type","setNewPostClick","payload","setProfileUserData","changePreloader","setStatus","updatePhotos","photos","setNewPostClickAC","setProfileUserDataAC","setStatusAC","updatePhotosAC","setProfileUserDataTC","param","dispatch","getState","userId","match","params","login","res","getProfileUserData","data","e","getStatusTC","getProfileStatus","updateStatusTC","updateProfileStatus","resultCode","updatePhotosTC","photo","updateProfilePhoto"],"mappings":"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","sourcesContent":["import {v1} from 'uuid';\r\nimport {AppThunk} from '../store';\r\nimport {profileAPI, ProfileDataType} from '../../api/profileApi';\r\nimport {changePreloaderAC, enumCommonActionType, preloaderACType} from '../../common/commonReducer';\r\nimport {errorResponse} from '../../utils/util-error';\r\n\r\nexport enum enumProfileActionType {\r\n    setNewPostClick = 'PROFILE/SET-NEW-POST-CLICK',\r\n    setProfileUserData = 'PROFILE/SET-PROFILE-USER-DATA',\r\n    setStatus = 'PROFILE/SET-STATUS',\r\n    updatePhotos = 'PROFILE/UPDATE-PHOTOS'\r\n}\r\n\r\nconst initialState = {\r\n    postsData: [\r\n        {id: v1(), message: 'Memento mori', likeCount: 12},\r\n        {id: v1(), message: 'How are you guys?', likeCount: 212},\r\n        {id: v1(), message: 'Hello world!', likeCount: 1212},\r\n    ],\r\n    userProfilePage: {} as ProfileDataType,\r\n    preloader: false,\r\n    status: ''\r\n}\r\nexport const profilePageReducer = (state: initialStateType = initialState, action: ProfileActionType): initialStateType => {\r\n    switch (action.type) {\r\n        case enumProfileActionType.setNewPostClick:\r\n            return {\r\n                ...state, postsData: [{...action.payload},\r\n                    ...state.postsData]\r\n            }\r\n        case enumProfileActionType.setProfileUserData:\r\n        case enumCommonActionType.changePreloader:\r\n        case enumProfileActionType.setStatus:\r\n            return {...state, ...action.payload}\r\n        case enumProfileActionType.updatePhotos:\r\n            return {...state, userProfilePage: {...state.userProfilePage, ...action.payload.photos}}\r\n        default :\r\n            return {...state}\r\n    }\r\n}\r\n\r\n//action\r\nexport const setNewPostClickAC = (message: string) => {\r\n    return {\r\n        type: enumProfileActionType.setNewPostClick,\r\n        payload: {message, likeCount: 0, id: v1()},\r\n    } as const\r\n}\r\nexport const setProfileUserDataAC = (userProfilePage: ProfileDataType) => {\r\n    return {\r\n        type: enumProfileActionType.setProfileUserData,\r\n        payload: {userProfilePage}\r\n    } as const\r\n}\r\nexport const setStatusAC = (status: string) => {\r\n    return {\r\n        type: enumProfileActionType.setStatus,\r\n        payload: {status},\r\n    } as const\r\n}\r\nconst updatePhotosAC = (photos: { small: string, large: string }) => {\r\n    return {\r\n        type: enumProfileActionType.updatePhotos,\r\n        payload: {photos}\r\n    } as const\r\n}\r\n\r\n\r\n//thunk\r\nexport const setProfileUserDataTC = (param: any): AppThunk =>\r\n    async (dispatch, getState) => {\r\n        dispatch(changePreloaderAC(true))\r\n        let userId = param.match.params.userId\r\n        if (!userId) {\r\n            const id = getState().login.id\r\n            userId = id\r\n        }\r\n        try {\r\n            const res = await profileAPI.getProfileUserData(userId)\r\n            dispatch(setProfileUserDataAC(res.data))\r\n            dispatch(changePreloaderAC(false))\r\n        } catch (e) {\r\n            errorResponse(e)\r\n        }\r\n    }\r\nexport const getStatusTC = (param: any): AppThunk =>\r\n    async (dispatch, getState) => {\r\n        let userId = param.match.params.userId\r\n        if (!userId) {\r\n            const id = getState().login.id\r\n            userId = id\r\n        }\r\n        try {\r\n            const res = await profileAPI.getProfileStatus(userId)\r\n            dispatch(setStatusAC(res.data))\r\n        } catch (e) {\r\n            errorResponse(e)\r\n        }\r\n\r\n    }\r\nexport const updateStatusTC = (status: string): AppThunk =>\r\n    async dispatch => {\r\n        const res = await profileAPI.updateProfileStatus(status)\r\n        if (res.data.resultCode === 0) dispatch(setStatusAC(status))\r\n    }\r\nexport const updatePhotosTC = (photo: File): AppThunk => async dispatch => {\r\n    try {\r\n        const res  = await profileAPI.updateProfilePhoto(photo)\r\n        dispatch(updatePhotosAC(res.data.data))\r\n    } catch (e) {\r\n        errorResponse(e)\r\n    }\r\n}\r\n\r\n//type\r\ntype initialStateType = typeof initialState\r\nexport type ProfileActionType = ReturnType<typeof setNewPostClickAC>\r\n    | ReturnType<typeof setProfileUserDataAC>\r\n    | preloaderACType\r\n    | ReturnType<typeof setStatusAC>\r\n    | ReturnType<typeof updatePhotosAC>"]},"metadata":{},"sourceType":"module"}